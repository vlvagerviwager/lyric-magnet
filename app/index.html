<!DOCTYPE html>
<html lang="en">

	<head>
	    <meta charset="utf-8">
		<title>lyric magnet.</title>
		<meta name="description" content="">
		<meta name="author" content="zky829">
		
		<!-- CSS -->
		<link rel="stylesheet" href="css/magnet.css">
		<!-- TODO: Skeleton CSS -->
		
		<!-- Scripts -->
		<script src="js/jquery-1.11.1.min.js"></script>
		<script src="js/jquery-ui-1.10.4.custom.js"></script>
		<script src="js/html2canvas.js" type="text/javascript"></script>
		<script src="js/base64.js" type="text/javascript"></script>
		<script src="js/canvas2image.js" type="text/javascript"></script>
		
		<!-- Mobile Specific Metas -->
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

		<!-- IE compatibility -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
			<script src="excanvas.js"></script>
		<![endif]-->
		  
		<script>
			$(function() {
				$( "#magnet" ).draggable();
			});
		</script> 
		
		<script type="text/javascript">
			function createMagnet(text) {
				// Create new magnet and set styling
				var newMagnet = document.createElement("p");	
				newMagnet.appendChild(text);
				$(newMagnet).draggable();
				return newMagnet;
			}
			
			// Get and return array of text for magnets
			function getWords(max) {
				var site = $("#site").val();
				// http://mikeygee.com/blog/scrape2.html
				// http://scotch.io/tutorials/javascript/scraping-the-web-with-node-js

				return ["telethon"];
			}

			// Get rid of duplicates, sort randomly (if more than max), and only return max number of words
			function pruneWords(words, max) {

			}
			
			function stickMagnet() {
				var maxMagnets = $("#max").val();	
				for(var i = 0; i < maxMagnets; i++) {
					// Get the text and append to each magnet
					var words = getWords(maxMagnets);	//TODO
					
					for(var j = 0; j < words.length; j++) {
						var text = document.createTextNode(words[j]);
						var newMagnet = createMagnet(text);
					}
				
					// Stick magnets to fridge
					$("#fridge").append(newMagnet);
				}
			}

			function exportFridge() {
				html2canvas($("#fridge"), {
					onrendered: function(canvas) {
					theCanvas = canvas;
						document.body.appendChild(canvas);

						// Convert and download as image 
						Canvas2Image.saveAsPNG(canvas); 
						$("#export").append(canvas);
					
						// Clean up 
						document.body.removeChild(canvas);
					}
				});

			}

		</script>
	</head>
	
	<body> 
		<section id="play">
		    <form class="horiz-menu">
		       <fieldset>
		            <input placeholder="Artist name">

		            <label>Select site</label>
		            <select id ="site">
		               <option value = "http://lyrics.wikia.com/Lyrics_Wiki">LyricWikia</option>
		            </select>

		            <input id="max" 
		            	type="number"
						min="0"
						max="50"
						step="1"
						value="5">

					<input type="submit" value="play" onclick="stickMagnet(); return false;">
					<input id="export" type="submit" value="save" onclick="exportFridge();">	<!-- export as image / interactive -->
		       </fieldset>
			</form>
		</section>
		<nav>
			<ul class="horiz-menu">
				<li><a href="">about</a></li>
				<li><a href="index.html">home</a></li>
			</ul>
		</nav>
		<div id="fridge" class="fridge-style">
			<script>stickMagnet()</script>
		</div>

		<div id="export"></div>
	</body>

</html>
